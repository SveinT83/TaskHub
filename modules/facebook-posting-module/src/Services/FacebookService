<?php

namespace Modules\FacebookModule\Services;

use Facebook\Facebook;

class FacebookService
{
    protected $fb;

    public function __construct()
    {
        $this->fb = new Facebook([
            'app_id' => config('facebook.app_id'),
            'app_secret' => config('facebook.app_secret'),
            'default_graph_version' => config('facebook.default_graph_version'),
        ]);
    }

    public function postToFacebook($accessToken, $message)
    {
        try {
            $response = $this->fb->post('/me/feed', [
                'message' => $message,
            ], $accessToken);

            return $response->getDecodedBody();
        } catch (\Facebook\Exceptions\FacebookResponseException $e) {
            return 'Error: ' . $e->getMessage();
        } catch (\Facebook\Exceptions\FacebookSDKException $e) {
            return 'Error: ' . $e->getMessage();
        }
    }
}
